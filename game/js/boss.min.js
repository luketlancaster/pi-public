!function(){"use strict";function e(){game.physics.startSystem(Phaser.Physics.ARCADE),u=game.score,S=game.hitCount,v=game.add.audio("explosion"),x=game.add.audio("shoot"),game.world.setBounds(0,0,800,640),game.bg=game.add.tileSprite(0,0,800,640,"bossBG"),r=game.add.tilemap("bossfight"),r.addTilesetImage("steampunk"),r.addTilesetImage("blocks"),r.setCollisionByExclusion([1]),c=r.createLayer("platforms"),c.resizeWorld(),E=game.add.sprite(12,520,"head"),game.physics.enable(E,Phaser.Physics.ARCADE),E.body.collideWorldBounds=!0,E.body.setSize(25,50,19,0),E.body.gravity.y=450,E.animations.add("left",[2]),E.animations.add("right",[1]),m=game.input.keyboard.createCursorKeys(),f=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),game.camera.follow(E,Phaser.Camera.FOLLOW_TOPDOWN_TIGHT),w=game.add.sprite(640,200,"jwb"),game.physics.enable(w,Phaser.Physics.ARCADE),w.animations.add("mad",[0,1],10,!0),w.body.velocity.y=200,A=game.add.group(),A.enableBody=!0,A.createMultiple(5,"bullet"),A.setAll("body.setSize",31,15),g=game.add.group(),g.enableBody=!0,g.createMultiple(2,"bowtie"),g.setAll("body.setSize",64,36),p=game.add.text(20,20,"Local Artists' Vinyl: "+game.score,{fontSize:"32px",fill:"#FFF",align:"center"}),p.fixedToCamera=!0,b=game.add.text(660,20,"Health: "+game.hitCount,{fontSize:"32px",fill:"#FFF"}),b.fixedToCamera=!0,F={font:"32px Arial",fill:"#fff",wordWrap:!0,wordWrapWidth:w.width,align:"center"},C=game.add.text(0,0,"You'll Never Get Me, Abe!",F),C.anchor.set(.5)}function t(){game.physics.arcade.collide(E,c),game.physics.arcade.collide(w,c),game.physics.arcade.collide(A,c,s,null,this),game.physics.arcade.overlap(A,E,y,null,this),game.physics.arcade.overlap(g,c,d,null,this),game.physics.arcade.overlap(g,w,o,null,this),E.body.velocity.x=0,w.animations.play("mad"),m.left.isDown?(E.body.velocity.x=-250,E.animations.play("left")):m.right.isDown?(E.body.velocity.x=250,E.animations.play("right")):E.frame=0,m.up.isDown&&E.body.onFloor()&&game.time.now>M&&(E.body.velocity.y=-300,M=game.time.now+750),g.forEachAlive(function(e){var t=600;Math.abs(E.x-e.x)>=t&&e.kill()},this),f.isDown&&a(),B=E.body.velocity.x>=0?"right":"left",w.body.blocked.down&&(w.body.velocity.y=-200,T++),w.body.blocked.up&&(w.body.velocity.y=200,T++),w.body.blocked.left&&(w.body.velocity.x=200,T++),w.body.blocked.right&&(w.body.velocity.x=-200,T++),4===T&&(w.body.velocity.y=200,w.body.velocity.x=-200),20===T&&(w.body.velocity.x=0,T=0),game.time.now>z&&3>W&&(k=A.getFirstExists(!1),k&&(k.reset(w.x,w.y),k.body.velocity.x=-500,z=game.time.now+800,game.physics.arcade.moveToObject(k,E,500))),C.x=Math.floor(w.x+w.width/2)-100,C.y=Math.floor(w.y+w.height/2),2===T&&C.destroy(),u%10===1&&(S++,u++,b.text="Health: "+S),0===S&&n()}function a(){game.time.now>D&&"right"===B?(h=g.getFirstExists(!1),h&&(h.reset(E.x-30,E.y-10),h.body.velocity.x=600,D=game.time.now+350,x.play())):game.time.now>D&&"left"===B&&(h=g.getFirstExists(!1),h&&(h.reset(E.x-30,E.y-10),h.body.velocity.x=-500,D=game.time.now+750,x.play()))}function o(e,t){t.kill(),e.body.velocity.x*=3,e.body.velocity.y*=3,W++,3===W&&i()}function i(){w.body.velocity.x=0,w.body.velocity.y=0,C=game.add.text(0,0,"Ach! You got me this time, Abe!",F),C.anchor.set(.5),C.x=Math.floor(w.x+w.width/2)-100,C.y=Math.floor(w.y+w.height/2),P=game.add.button(300,150,"victoryButton",l,this)}function l(){this.game.state.start("finalMenu")}function d(e){e.kill()}function s(e){e.kill()}function y(e,t){e.animations.play("damage"),v.play(),t.kill(),e.body.x-=75,--S,b.text="Health: "+S}function n(){game.state.start("menu"),S=2}game.state.add("boss",{create:e,update:t});var r,c,m,g,h,b,u,p,f,x,v,w,A,k,C,F,P,E,M=0,B="right",D=0,S=3,T=0,W=0,z=0}();